#include "bluetooth.h"
#include "crypto.h"
#include "storage.h"
#include "btservice_gfp_api.h"
#include <fast_pair.h>

//#define ATS2875H_ID
//#define ATS2835P2_ID
//#define ATS2835P_ID

#define ATS2833_ID

#ifdef ATS2833_ID
	const uint8 MODEL_ID_ATS2833[3] = {0x1E, 0x89, 0xA7};
	const uint8 PRIVATE_ANTI_SPOOFING_KEY_ATS2833[32] = {
    0x0b, 0xfa, 0x93, 0x46, 0xcb, 0x1e, 0x27, 0x5f, 0x78, 0x01, 0x49, 0x36, 0x6c, 0x78, 0xdf, 0x42,
    0xb2, 0xaf, 0x0b, 0x79, 0xe4, 0x30, 0xc7, 0x20, 0x51, 0x9a, 0xc1, 0xfb, 0x6c, 0xba, 0x54, 0x6a
	};
#endif

/*
ACTIONS ATS2875H
Public Key
BmzDrVvtJEB3qKIfAuMAhLUVDGI82hPcDK3g3pNA1hhleWOfAPRnp7HseKIOPbG2na006wErtGrYHybAYIaAzA
Private Key
A7k7wiE8h0CBd9JCVvKYMLF5zlTtIIEnl165Dy8YzR8
0x32B26B
*/

/*
const uint8 MODEL_ID_ATS2875H[3] = {0x32,0xB2,0x6B};
const uint8 PRIVATE_ANTI_SPOOFING_KEY_ATS2875H[32] = {
    0x03, 0xb9, 0x3b, 0xc2, 0x21, 0x3c, 0x87, 0x40, 0x81, 0x77, 0xd2, 0x42, 0x56, 0xf2, 0x98, 0x30,
    0xb1, 0x79, 0xce, 0x54, 0xed, 0x20, 0x81, 0x27, 0x97, 0x5e, 0xb9, 0x0f, 0x2f, 0x18, 0xcd, 0x1f
};
*/

/*
ACTIONS ATS2835P
Public Key
BmDM1jXnt3tXXjdXNODzmb5MUvp/bMjaYhCqLl84Rht5hGuHml5dIoeUpLK72jIRuyNYD6raXr7xhxUb0Wzypw==
Private Key
GJgZM/yJDP/cmSAWDdoGPmCxTC6Q8D2ZpEosfvbskIw=
0x8F9F08
*/

/*
#ifdef ATS2835P_ID
	const uint8 MODEL_ID_ATS2835P[3] = {0x8F, 0x9F, 0x08};
	const uint8 PRIVATE_ANTI_SPOOFING_KEY_ATS2835P[32] = {
    0x18, 0x98, 0x19, 0x33, 0xfc, 0x89, 0x0c, 0xff, 0xdc, 0x99, 0x20, 0x16, 0x0d, 0xda, 0x06, 0x3e, 
    0x60, 0xb1, 0x4c, 0x2e, 0x90, 0xf0, 0x3d, 0x99, 0xa4, 0x4a, 0x2c, 0x7e, 0xf6, 0xec, 0x90, 0x8c
    };
#endif
*/

/*
ACTIONS ATS2835P
Public Key
rd4NMkWgqSef+sSWZ6G7RmftuVHPQsZJLn+Qp5HBu3j4GqZYzHomAqEZ/R9nGO2U/y9brj7eLgv8iaTLXOQYkA==
Private Key
HEKC/kSrLgFRpyiupwPwYrld3cbkoAOrA0cmdIXGDrI=
0x08DEA1
*/

/*
#ifdef ATS2835P2_ID
	const uint8 MODEL_ID_ATS2835P2[3] = {0x16, 0xE2, 0xDD};
	const uint8 PRIVATE_ANTI_SPOOFING_KEY_ATS2835P2[32] = {
	0x08, 0x38, 0xe4, 0xe9, 0xc7, 0x19, 0x24, 0x40, 0x83, 0xa6, 0x39, 0x92, 0x69, 0x04, 0x52, 0x69, 
	0xb9, 0xec, 0x76, 0xd2, 0x56, 0x2c, 0x9e, 0x6b, 0x92, 0x7a, 0x7c, 0xf1, 0x15, 0x0d, 0x9c, 0x4f
    };
#endif
*/

extern void* fastpair_init(uint8* model_id, uint8 *spoofing_key)
{
    CryptoProvider *crypto;
    StorageProvider *storage;
    BluetoothProvider *bluetooth;
    FastPair* handle = NULL;

    init_bluetooth(&bluetooth);
    init_storage(&storage);
    init_crypto(&crypto);

    if(!model_id || !spoofing_key){
        handle = fast_pair(MODEL_ID_ATS2833, PRIVATE_ANTI_SPOOFING_KEY_ATS2833, bluetooth, storage, crypto);
    }
    else{
        handle = fast_pair(model_id,spoofing_key, bluetooth, storage, crypto);    
    }
    return (void *)handle;
}

